<?xml version="1.0"?>
<openerp>
    <data>
        <record id="crm_case_form_view_leads_extended" model="ir.ui.view">
            <field name="name">crm.lead.form.inherit</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_leads"/>
            <field name="arch" type="xml">
                <data>
                    <xpath  expr="//notebook" position="inside">
                        <page string="Course(s) Info">
                            <separator colspan="4" string="Course Details"/>
                            <group col="4" colspan="4">
                                <field name="courses_interested"  widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                <field name="prospective_student"/>
                            </group>
                            <page string="Suitable Time Frame">
                                <separator colspan="4" string="Suitable Time Frame"/>
                                <group col="4" colspan="4">
                                    <field name="weekday" widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                    <field name="saturday" widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                    <field name="sunday" widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                </group>
                            </page>
                        </page>
                    </xpath>
                    <xpath  expr="//notebook/page[@string='Extra Info']" position="inside">
                        <group>
                            <field name="inquiry_date"/>
                        </group>
                    </xpath>

                    <xpath  expr="//div[@class='oe_right oe_button_box']" position="replace">
                        <div class="oe_right oe_button_box" name="buttons">
                            <button class="oe_inline oe_stat_button" type="action" context="{'default_opportunity_id': active_id, 'search_default_opportunity_id': active_id, 'default_partner_id': partner_id, 'default_duration': 1.0}" name="%(action_crm_followup)d" icon="fa-bell">
                                <div>Schedule<br/>Follow-up</div>
                            </button>
                        </div>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="crm_case_tree_view_oppor" model="ir.ui.view">
            <field name="name">crm.lead.oppor.form.inherit</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
                <data>
                    <xpath  expr="//notebook/page[@string='Lead']" position="inside">
                        <page string="Course(s) Info">
                            <separator colspan="4" string="Course Details"/>
                            <group name="Suitable Time Frame">
                                <field name="courses_interested"  widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                <field name="prospective_student"/>
                            </group>
                            <page string="Suitable Time Frame">
                                <separator colspan="4" string="Suitable Time Frame"/>
                                <group col="4" colspan="4">
                                    <field name="weekday" widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                    <field name="saturday" widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                    <field name="sunday" widget="many2many_tags" options="{'no_create_edit':'1'}"/>
                                </group>
                            </page>
                        </page>
                    </xpath>
                    <xpath  expr="//group[@string='Misc']" position="inside">
                        <field name="inquiry_date"/>
                    </xpath>
                    <xpath  expr="//div[@class='oe_right oe_button_box']" position="replace">
                        <div class="oe_right oe_button_box" name="buttons">
                            <button class="oe_inline oe_stat_button" type="action" context="{'default_opportunity_id': active_id, 'search_default_opportunity_id': active_id, 'default_partner_id': partner_id, 'default_duration': 1.0}" name="%(action_crm_followup)d" icon="fa-bell">
                                <div>Schedule<br/>Follow-up</div>
                            </button>
                        </div>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="view_crm_tracking_form_inherit" model="ir.ui.view">
            <field name="name">crm.tracking.form.inherit</field>
            <field name="model">crm.tracking.campaign</field>
            <field name="inherit_id" ref="crm.crm_tracking_campaign_form"/>
            <field name="arch" type="xml">
                <data>
                    <field name="section_id" position="after">
                        <field name="source_id"/>
                    </field>
                </data>
            </field>
        </record>

        <record id="view_crm_source_form_inherit" model="ir.ui.view">
            <field name="name">crm.source.form.inherit</field>
            <field name="model">crm.tracking.source</field>
            <field name="inherit_id" ref="crm.crm_tracking_source_view_form"/>
            <field name="arch" type="xml">
                <data>
                    <field name="name" position="after">
                        <field name="channel_id"/>
                    </field>
                </data>
            </field>
        </record>


        <!--<record id="new_lead" model="ir.actions.act_window">-->
        <!--<field name="name">Lead</field>-->
        <!--<field name="res_model">crm.lead</field>-->
        <!--<field name="view_type">form</field>-->
        <!--<field name="view_mode">form</field>-->
        <!--<field name="view_id" ref="crm_case_form_view_leads_extended"/>-->
        <!--</record>-->

        <record id="time_frame_form" model="ir.ui.view">
            <field name="name">time.frame.form</field>
            <field name="model">time.frame</field>
            <field name="priority" eval="8" />
            <field name="arch" type="xml">
                <form string="Time Frames" version="7.0">
                    <sheet>
                        <separator string="Time Frames" colspan="4" />
                        <group col="4">
                            <field name="name" />
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_crm_lead2opportunity_partner_inherit" model="ir.ui.view">
            <field name="name">view.crm.lead2opportunity.partner.inherit</field>
            <field name="model">crm.lead2opportunity.partner</field>
            <field name="inherit_id" ref="crm.view_crm_lead2opportunity_partner"/>
            <field name="arch" type="xml">
                <data>
                    <xpath  expr="//group[@name='action']" position="replace">
                        <group name="action" attrs="{'invisible': [('name', '!=', 'convert')]}">
                            <field name="action" on_change="onchange_action(action, context)" class="oe_inline"/>
                            <field name="partner_id"
                                   attrs="{'required': [('action', '=', 'exist')], 'invisible':[('action','!=','exist')]}"
                                   class="oe_inline" domain="[('is_student', '=', True)]"/>
                        </group>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="crm_oppor_form_view_leads_extended" model="ir.ui.view">
            <field name="name">crm.lead.oppor.form.inherit</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
                <xpath expr='//form[@string="Opportunities"]' position='attributes'>
                    <attribute name="create">false</attribute>
                </xpath>
            </field>
        </record>
        <!--<record id="crm_oppor_form_view_leads_extended" model="ir.ui.view">-->
        <!--<field name="name">crm.lead.oppor.form.inherit</field>-->
        <!--<field name="model">crm.lead</field>-->
        <!--<field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>-->
        <!--<field name="arch" type="xml">-->
        <!--<form string="Opportunities" create="false" edit="false"></form>-->
        <!--</field>-->
        <!--</record>-->

        <!--<record id="crm_case_kanban_view_leads_extended" model="ir.ui.view">-->
        <!--<field name="name">crm.lead.kanban.inherit</field>-->
        <!--<field name="model">crm.lead</field>-->
        <!--<field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>-->
        <!--<field name="arch" type="xml">-->
        <!--<xpath expr='//kanban[@string="Opportunities"]' position='attributes'>-->
        <!--<attribute name="create">false</attribute>-->
        <!--</xpath>-->
        <!--</field>-->
        <!--<record id="crm_case_form_view_leads_extendeds" model="ir.ui.view">-->
        <!--<field name="name">crm.lead.form.inherit</field>-->
        <!--<field name="model">crm.lead</field>-->
        <!--<field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>-->
        <!--<field name="arch" type="xml">-->

        <!--&lt;!&ndash;<kanban create="false"></kanban>&ndash;&gt;-->
        <!--</field>-->
        <!--</record>-->

        <!--<record id="crm_oppor_tree_view_leads_extended" model="ir.ui.view">-->
        <!--<field name="name">Opportunities Tree</field>-->
        <!--<field name="model">crm.lead</field>-->
        <!--<field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>-->
        <!--<field name="arch" type="xml">-->
        <!--<tree></tree>-->
        <!--&lt;!&ndash;<field name="Opportunities Tree" position="attributes">&ndash;&gt;-->
        <!--&lt;!&ndash;&lt;!&ndash;<attributes name="attrs">&ndash;&gt;&ndash;&gt;-->
        <!--&lt;!&ndash;&lt;!&ndash;'create':'false'&ndash;&gt;&ndash;&gt;-->
        <!--&lt;!&ndash;&lt;!&ndash;</attributes>&ndash;&gt;&ndash;&gt;-->
        <!--&lt;!&ndash;</field>&ndash;&gt;-->

        <!--</field>-->
        <!--</record>-->

        <!--<record id="crm_case_form_view_leads_extended" model="ir.ui.view">-->
        <!--<field name="name">crm.form.form.inherit</field>-->
        <!--<field name="model">crm.lead</field>-->
        <!--<field name="inherit_id" ref="marketing_crm.view_crm_lead_form"/>-->
        <!--<field name="arch" type="xml">-->
        <!--&lt;!&ndash;<xpath expr='//tree[@string="Opportunities"]' position='attributes'>&ndash;&gt;-->
        <!--&lt;!&ndash;<attribute name="create">false</attribute>&ndash;&gt;-->
        <!--&lt;!&ndash;</xpath>&ndash;&gt;-->
        <!--<data>-->
        <!--<xpath expr="//group[@string='Marketing']" position="replace">-->
        <!--<group string="Marketing">-->
        <!--<field name="campaign_id"/>-->
        <!--<field name="source_id"/>-->
        <!--<field name="medium_id"/>-->
        <!--</group>-->
        <!--</xpath>-->
        <!--</data>-->
        <!--</field>-->
        <!--</record>-->

        <!--<record id="view_crm_lead2opportunity_partner_inherit" model="ir.ui.view">-->
        <!--<field name="name">view.crm.lead2opportunity.partner.inherit</field>-->
        <!--<field name="model">op.crm.lead2opportunity.partner</field>-->
        <!--<field name="inherit_id" ref="crm.view_crm_lead2opportunity_partner"/>-->
        <!--<field name="arch" type="xml">-->
        <!--<data>-->
        <!--<xpath expr='//group[@name="action"]' position='replace'>-->
        <!--<group name="action" attrs="{'invisible': [('name', '!=', 'convert')]}">-->
        <!--&lt;!&ndash;<field name="action" on_change="onchange_action(action, context)" class="oe_inline"/>&ndash;&gt;-->
        <!--&lt;!&ndash;&lt;!&ndash;<field name="new"/>&ndash;&gt;&ndash;&gt;-->
        <!--&lt;!&ndash;<field name="partner_id"&ndash;&gt;-->
        <!--&lt;!&ndash;attrs="{'required': [('action', '=', 'exist')], 'invisible':[('action','!=','exist')]}"&ndash;&gt;-->
        <!--&lt;!&ndash;class="oe_inline"/>&ndash;&gt;-->
        <!--</group>-->
        <!--</xpath>-->
        <!--</data>-->
        <!--</field>-->
        <!--</record>-->

        <!--<record id="view_crm_lead2opportunity_partner" model="ir.ui.view">-->
        <!--<field name="name">crm.lead2opportunity.partner.form</field>-->
        <!--<field name="model">crm.lead2opportunity.partner</field>-->
        <!--<field name="arch" type="xml">-->
        <!--<form string="Convert to Opportunity">-->
        <!--<group name="name">-->
        <!--<field name="name" class="oe_inline"/>-->
        <!--</group>-->
        <!--<group string="Assign opportunities to">-->
        <!--<field name="user_id" class="oe_inline" on_change="on_change_user(user_id, section_id, context)"/>-->
        <!--<field name="section_id" class="oe_inline" groups="base.group_multi_salesteams"/>-->
        <!--</group>-->
        <!--<group string="Opportunities">-->
        <!--<field name="opportunity_ids" attrs="{'invisible': [('name', '!=', 'merge')]}" nolabel="1">-->
        <!--<tree>-->
        <!--<field name="create_date"/>-->
        <!--<field name="name"/>-->
        <!--<field name="type"/>-->
        <!--<field name="contact_name"/>-->
        <!--<field name="country_id" invisible="context.get('invisible_country', True)"/>-->
        <!--<field name="email_from"/>-->
        <!--<field name="phone"/>-->
        <!--<field name="stage_id"/>-->
        <!--<field name="user_id"/>-->
        <!--<field name="section_id" groups="base.group_multi_salesteams"/>-->
        <!--</tree>-->
        <!--</field>-->
        <!--</group>-->
        <!--<group name="action" attrs="{'invisible': [('name', '!=', 'convert')]}">-->
        <!--<field name="action" on_change="onchange_action(action, context)" class="oe_inline"/>-->
        <!--<field name="partner_id"-->
        <!--attrs="{'required': [('action', '=', 'exist')], 'invisible':[('action','!=','exist')]}"-->
        <!--class="oe_inline"/>-->
        <!--</group>-->
        <!--<footer>-->
        <!--<button name="action_apply" string="Create Opportunity" type="object" class="oe_highlight"/>-->
        <!--or-->
        <!--<button string="Cancel" class="oe_link" special="cancel"/>-->
        <!--</footer>-->
        <!--</form>-->
        <!--</field>-->
        <!--</record>-->



        <record id="time_frame_tree" model="ir.ui.view">
            <field name="name">time.frame.tree</field>
            <field name="model">time.frame</field>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <tree string="Time Frames">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="action_time_frame" model="ir.actions.act_window">
            <field name="name">Time Frame</field>
            <field name="res_model">time.frame</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="time_frame_tree"/>
        </record>

        <record id="crm_followup_form" model="ir.ui.view">
            <field name="name">crm.followup</field>
            <field name="model">calendar.event</field>
            <field name="priority" eval="8" />
            <field name="arch" type="xml">
                <form string="Follow Up">
                    <sheet>
                        <field name="state" invisible="1"/>
                        <field name="is_attendee" invisible="1"/>
                        <field name="attendee_status" invisible="1"/>
                        <div class="oe_title">
                            <div class="oe_edit_only">
                                <label for="name" string="Follow-up Subject"/>
                            </div>
                            <h1>
                                <field name="name" />
                            </h1>
                            <div class="oe_edit_only">
                                <label for="type" string="Follow-up Type"/>
                            </div>
                            <h2>
                                <field name="type" />
                            </h2>
                            <label for="partner_ids" string="Attendees" class="oe_edit_only"/>
                            <h2>
                                <field name="partner_ids" widget="many2manyattendee"
                                       context="{'force_email':True}"
                                       on_change="onchange_partner_ids(partner_ids)"
                                       class="oe_inline"/>
                            </h2>
                        </div>
                        <notebook>
                            <page string="Meeting Details">
                                <group attrs="{'invisible': [('recurrency','==',False)]}" class="oe_edit_only ">
                                    <p class='alert alert-warning'> This event is linked to a recurrence...<br/>
                                        <button type="object" name="open_after_detach_event"  string="Update only this instance"  help="Click here to update only this instance and not all recurrences. " class="oe_link"/>
                                    </p>
                                </group>
                                <group>
                                    <group>
                                        <field name="start" attrs="{'invisible': True}"/>
                                        <field name="stop" attrs="{'invisible': True}"/>

                                        <field name="start_date" string="Starting at" on_change="onchange_dates('start', start_date, stop_date, allday, True)" attrs="{'invisible': [('allday','=',False)]}"/>
                                        <field name="stop_date" string="Ending at" on_change="onchange_dates('stop', start_date, stop_date, allday, True)" attrs="{'invisible': [('allday','=',False)]}"/>

                                        <field name="start_datetime" string="Starting at" on_change="onchange_dates('start', start_datetime, stop_datetime, allday, False)" attrs="{'invisible': [('allday','=',True)]}"/>
                                        <field name="stop_datetime" string="Ending at" on_change="onchange_dates('stop', start_datetime, stop_datetime, allday, False)" attrs="{'invisible': [('allday','=',True)]}"/>
                                        <label for="allday"/>
                                        <div>
                                            <field name="allday"  class="oe_inline" on_change="onchange_allday(start, stop, start_date, stop_date, start_datetime, stop_datetime, allday)"/>
                                        </div>
                                        <field name="duration" widget="float_time" class="oe_inline" attrs="{ 'invisible': True }"/>
                                    </group>
                                    <group>
                                        <field name="categ_ids" widget="many2many_tags" />
                                        <field name="alarm_ids" widget="many2many_tags" />
                                        <field name="location" string="new one"/>
                                    </group>

                                </group>
                                <label for="description"/>
                                <field name="description"/>
                            </page>
                            <page string="Options">
                                <group>
                                    <group col="1">
                                        <group>
                                            <field name="recurrency"/>
                                        </group>
                                        <group attrs="{'invisible': [('recurrency','=',False)]}">
                                            <label for="interval"/>
                                            <div>
                                                <field name="interval" attrs="{'required': [('recurrency','==',True)]}" class="oe_inline"/>
                                                <field name="rrule_type" attrs="{'required': [('recurrency','==',True)]}" class="oe_inline"/>
                                            </div>
                                            <label string="Until" for="end_type"/>
                                            <div>
                                                <field name="end_type" attrs="{'required': [('recurrency','==',True)]}" class="oe_inline"/>
                                                <field name="count" attrs="{'invisible': [('end_type', '!=', 'count')], 'required': [('recurrency','==',True)]}" class="oe_inline"/>
                                                <field name="final_date" attrs="{'invisible': [('end_type', '!=', 'end_date')], 'required': [('end_type', '=', 'end_date')]}" class="oe_inline"/>
                                            </div>
                                            <label string="Select Weekdays" attrs="{'invisible' :[('rrule_type','not in', ['weekly'])]}"/>
                                            <group col="2" colspan="1" name="weekdays" attrs="{'invisible' :[('rrule_type','not in', ['weekly'])]}" >
                                                <field name="mo" />
                                                <field name="tu" />
                                                <field name="we" />
                                                <field name="th" />
                                                <field name="fr" />
                                                <field name="sa" />
                                                <field name="su" />
                                            </group>

                                            <label string="Day of Month"
                                                   attrs="{'invisible': [('rrule_type','!=','monthly')]}"/>

                                            <div attrs="{'invisible': [('rrule_type','!=','monthly')]}">
                                                <field name="month_by"/>
                                                <field name="day"
                                                       attrs="{'required': [('month_by','=','date'), ('rrule_type','=','monthly')],
                                                    'invisible': [('month_by','=','day')]}"/>
                                                <field name="byday" string="The"
                                                       attrs="{'required': [('month_by','=','day'), ('rrule_type','=','monthly')], 'invisible': [('month_by','=','date')]}"/>
                                                <field name="week_list" nolabel="1"
                                                       attrs="{'required': [('month_by','=','day'), ('rrule_type','=','monthly')], 'invisible': [('month_by','=','date')]}"/>
                                            </div>
                                        </group>
                                    </group>
                                    <group>
                                        <field name="class"/>
                                        <field name="show_as"/>
                                        <field name="rrule" invisible="1" readonly="0" />
                                        <field name="recurrent_id" invisible="1" />
                                    </group>
                                </group>
                            </page>

                            <page string="Invitations" groups="base.group_no_one">
                                <button name="do_sendmail" type="object" string="Send mail" icon="terp-mail-message-new" class="oe_link"/>
                                <field name="attendee_ids" widget="one2many" >
                                    <tree string="Invitation details" editable="top" create="false" delete="false">
                                        <field name="partner_id" />
                                        <field name="state" />
                                        <field name="email" widget="email"/>

                                        <button name="do_tentative" states="needsAction,declined,accepted" string="Uncertain" type="object" icon="terp-crm" />
                                        <button name="do_accept" string="Accept" states="needsAction,tentative,declined" type="object" icon="gtk-apply"/>
                                        <button name="do_decline" string="Decline" states="needsAction,tentative,accepted" type="object" icon="gtk-cancel"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Misc" groups="base.group_no_one">
                                <label string="Owner"/>
                                <field name="user_id" />

                            </page>

                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread" />
                    </div>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="crm_followup_tree">
            <field name="name">crm.followup</field>
            <field name="model">calendar.event</field>
            <field name="arch" type="xml">
                <tree string="Follow Up" fonts="bold:message_unread==True">
                    <field name="name" string="Subject"/>
                    <field name="type" string="Type"/>
                    <field name="allday" invisible="True"/>
                    <field name="start_date" string="Date"/>
                    <field name="start_datetime" string="Date Time"/>
                    <field name="user_id"/>
                    <field name="location"/>
                    <field name="show_as"/>
                    <field name="class" string="Privacy"/>
                    <field name="state" invisible="True"/>
                    <field name="duration"/>
                    <field name="message_unread" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="action_crm_followup" model="ir.actions.act_window">
            <field name="name">Follow Up</field>
            <field name="res_model">calendar.event</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="crm_followup_form"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_view_crm_followup_tree">
            <field name="act_window_id" ref="action_crm_followup"/>
            <field name="sequence" eval="2"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="crm_followup_tree"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_view_crm_followup_form">
            <field name="act_window_id" ref="action_crm_followup"/>
            <field name="sequence" eval="3"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="crm_followup_form"/>
        </record>

        <menuitem id="time_frame" name="Time Frames" parent="base.menu_base_config" action="action_time_frame"/>
        <menuitem id="folow_up" name="Follow up" parent="base.menu_base_config" action="action_crm_followup"/>
    </data>
</openerp>


